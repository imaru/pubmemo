<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="pandoc" />

        <meta name="author" content="Toshihide Imaruoka" />
    
    
    <title>midori3</title>

        <script src="site_libs/header-attrs-2.23/header-attrs.js"></script>
        <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
        <script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
        <script src="site_libs/navigation-1.1/tabsets.js"></script>
        <link href="site_libs/downcute-0.1/downcute.css" rel="stylesheet" />
        <link href="site_libs/downcute-0.1/downcute_fonts_embed.css" rel="stylesheet" />
        <script src="site_libs/downcute-0.1/downcute_styles.js"></script>
        <script src="site_libs/downcute-0.1/downcute.js"></script>
        <script src="site_libs/prism-1.22/prism.js"></script>
    
    
    
        <link rel="stylesheet" href="mycss.css" type="text/css" />
    
    <!-- tabsets -->
    <script>
      $(document).ready(function () {
	  window.buildTabsets("toc");
      });
      $(document).ready(function () {
	  $('.tabset-dropdown > .nav-tabs > li').click(function () {
	      $(this).parent().toggleClass('nav-tabs-open')
	  });
      });
    </script>

    <!-- code folding -->
    
    <!-- code download -->
    
    <!-- tabsets dropdown -->

    <style type="text/css">
      .tabset-dropdown > .nav-tabs {
	  display: inline-table;
	  max-height: 500px;
	  min-height: 44px;
	  overflow-y: auto;
	  background: white;
	  border: 1px solid #ddd;
	  border-radius: 4px;
      }
      
      .tabset-dropdown > .nav-tabs > li.active:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
	  content: "&#xe258;";
	  border: none;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
	  content: "";
	  font-family: 'Glyphicons Halflings';
	  display: inline-block;
	  padding: 10px;
	  border-right: 1px solid #ddd;
      }
      
      .tabset-dropdown > .nav-tabs > li.active {
	  display: block;
      }

      .tabset-dropdown > .nav-tabs > li.active a {
  	  padding: 0 15px !important;
      }

      .tabset-dropdown > .nav-tabs > li > a,
      .tabset-dropdown > .nav-tabs > li > a:focus,
      .tabset-dropdown > .nav-tabs > li > a:hover {
	  border: none;
	  display: inline-block;
	  border-radius: 4px;
	  background-color: transparent;
      }
      
      .tabset-dropdown > .nav-tabs.nav-tabs-open > li {
	  display: block;
	  float: none;
      }
      
      .tabset-dropdown > .nav-tabs > li {
	  display: none;
	  margin-left: 0 !important;
      }
    </style>
    
</head>

<body class="preload">

   	
               <!-- downcute start -->   
   <div id="docute" class="Root theme-default">
     <div class="Page layout-narrow">
      <div class="Wrap">
        <div class="Sidebar">
          <div class="SidebarItems" id="toc">
            <ul>
            <li><a href="#一般化線形モデルーポアソン回帰"
            id="toc-一般化線形モデルーポアソン回帰">3.
            一般化線形モデルーポアソン回帰</a>
            <ul>
            <li><a href="#例題個体ごとに平均種子数が異なる場合"
            id="toc-例題個体ごとに平均種子数が異なる場合">3.1
            例題：個体ごとに平均種子数が異なる場合</a></li>
            <li><a href="#観測されたデータの概要を調べる"
            id="toc-観測されたデータの概要を調べる">3.2
            観測されたデータの概要を調べる</a></li>
            <li><a href="#統計モデリングの前にデータを図示する"
            id="toc-統計モデリングの前にデータを図示する">3.3
            統計モデリングの前にデータを図示する</a></li>
            <li><a href="#ポアソン回帰の統計モデル"
            id="toc-ポアソン回帰の統計モデル">3.4
            ポアソン回帰の統計モデル</a></li>
            <li><a href="#説明変数が因子型の統計モデル"
            id="toc-説明変数が因子型の統計モデル">3.5
            説明変数が因子型の統計モデル</a></li>
            <li><a href="#説明変数が数量型因子型の統計モデル"
            id="toc-説明変数が数量型因子型の統計モデル">3.6
            説明変数が数量型＋因子型の統計モデル</a></li>
            <li><a href="#何でも正規分布何でも直線には無理がある"
            id="toc-何でも正規分布何でも直線には無理がある">3.7
            「何でも正規分布」「何でも直線」には無理がある</a></li>
            </ul></li>
            </ul>
          </div>
          <div data-position="sidebar:post-end" class="InjectedComponents"><div class="dark-theme-toggler"><div class="toggle "><div class="toggle-track"><div class="toggle-track-check"><img  src="data:image/png;base64,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" role="presentation" style="pointer-events: none;" width="16" height="16"></div> <div class="toggle-track-x"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAABwNJREFUWAmtV1tsFFUY/s6Z2d22zLYlZakUCRVaQcqlWIiCiS1gTEB9UAO+GR9En3iQGI0xJiSiRB98MjEq8cEQTSBeHhQM0V7whtEGDWC90BYitxahtNtu25058/v/ZzvLbilawJNM5+yZ89+//1LgJhYRNLW1uDfBAvpGiIk2O5auvfFxqIH3ZJ8/u06GN6Z9+wVl5SjcD1IbZa/UPkPyYl2uR4dreoD2bnbYxTlBBRytkHXtAREphP5KuH4lddx9h70yxX05t7yYXwGb6W8nx1jibpl2rFlGBxcG9M18okOrn7Bnk/BAO/4bI0UeEE1zjBp3UmvjOxJXJdaKN/ZiIu4tOZrAb4aTdZAZArKmWeiiJZ6jt5tiagdCS9+6cgO1Ne6Mvhe+ixTIfyDVhipnK9p+P0Edqx9RW/YZtQVGmOLChRxNNlyPsTEgPQKMB3dbEHa0h1awYmQ83enTd2vmUtvKd1Glv2RkzBb+kZGRrKtjzG60Wguhd/lJZBingbcfWWe72vjT75bJDrhYtvA0hrurETDr5HyF2Knb1MM4ab//xIoOqueA0edRnkkinTyJdYvqLFDZO4zUPFCvVoDjJq4T7TE61IWh4x5KqxX5KVKkX8WZ/t2ov2cb3MHt4dhIyOxIJxJOOF6xRx/99BksXLoecWcXytILMNBDqKpnGZWPquYfPxY8iXGR9fK+SgFrgcRPXPjVqhehL+3EmZ5RGJQi1QBU8TPThQnOQzm+5UXGIcetUeEAfP13VwzpI+w1jGJWdSliNfvVhiMPiOsllJag4M/UGHiqM6dlBb2OTLKHHV6KkvogrJ4XhBWniWK/Gp1MQyf93FOeUXKmKk/FzJxbQtKLjFXYT4USupy8fQVir2ynVEBiZMG0qtOHMS/AW4Gwrk7BG3C1F0B5nqNKE0CME4MfVRLPnXkBKe+ipvoFhNQywOhdghvLi0F8ReyVXV4BKTBRbbe5f64zR/DHsdZw1hJfeWlHl/GNRJzDxrd5m192z78TMaVnKELZoINZS4BzQ7vtnZljSnha/pPCbkuxzXcupYwI5tIeCpGc0Yp9tWHZQy/rmYhRfNgg4bHJBYLzGkxsRJF4XKlE2jBOHNSv3kY7Tj6vthzPFl61BrYwqFlmEQhtSVXmLiksxLmtRgYXI1ULU61JJ4eVKmG3/5sCVgpbMT6OMJ2E08/29Xf3w6v4FnHdCjfWgXu/O8Z5mLdCkeRs2khHe1DqOtQwbHWTAnM5S2HNmhALYo5KjkPFrMMKjZl6HxhWIAb0BqE+/73GrBRQUsKYiBu4JX8ycI6wtw+i5ef3NZpsrKVSHYCP37jwGDgeE1SA0S/xtl5SU2fs1ApEp0qTLVRjgyycDSsLHMSwmFltZMStR3uLLg6BdLhDa5dC6ryU2pHBe1BVO9tUcwfitJt2CLJZUHoG6T7Op75u0IyK31TCPcwFqgPk/KCaD3dFOuZBCO7xvCT/j048b3I3c7F2+WuOW7qdgkucFYlcQ4qop3yzTX7WaKfOCccye3Ts1Etq0+a/BHCF1yPgF3tAUkR6OrtGmo6gl94qqcXKh3rDyrOkPa58URoWcov2Mo6M+0QjrqKB+b7++oMa9Sz+ZkM0mie6aAtnGUvhmxaI+TogPOSQedgWioGSHFLn3v4kLh4HRspNmOGv41k+55siLFp2z6xYeJjhljFcbmxJlr4ga06TbevSByz/glQq4BJx46/c+237PbBqEYKxX3HpmKZEnQnr65X20hqJYaNcLoFOLiJk2LuBbyg7Q0OEn+hm0P3honxFD6rdxYorKpeIoi4YSSvyQHQIbM5t4+YNxLj/OxhVOOE4585qGpjnq+wSx6Q9CtNxTjd5klB+g6Mv36r0+b9cZFi44WYkHdG2ZWb3TtOUOXyVAlKlpGvJIAJ3eBMyfYS5C0qRZGtC85j+4sOasDe9xznPYezhhO/2Q6eP2fSOvYHOjtuQ1a9Q1VKynVDaMc8E0tptdxUsTFpFIYjcZKcbnoaQTNdiqCwNlL4G7oziSqGnT1ALf34vhk4R5zU3qYV9ONp9K88RtouShE68JwaU8dFw5W617shWa9ykeaBIn2hcsvPgL00k45QdTCZuSVcTRNs+8fnyLvooQfR5iujAnR9bxfY2xOVOxFS8SK3Le0l48VyYu1M8HRe5JD8wKPTjYnifaK3Wfn/GChYQ8ZAi6WRzWgqLV5YrsVLnZaVSoXU1g9gOIDwFySiGi+Zdrnzr7J3r+SMuszlcQCRn8lNGcTuSy2jOI7o9mxjZo+vR3ej3tN+ifRSOyUTS0+VMOid93cCubeiy/6TImS0QxRSCq2vxKr45zV+FQnjWH6D2xg+E9EatLcLAdHTgtGGD80D6jM0+aOl4wJgO/f96R2aJKCQ3yvgftRhdFMOpd6oAAAAASUVORK5CYII=" role="presentation" style="pointer-events: none;" width="16" height="16"></div></div> <div class="toggle-thumb"></div></div> <input type="checkbox" aria-label="Switch between Dark and Default theme" class="toggler-screen-reader-only"></div></div>
        </div>
        <div class="Main">
          <div class="Content" id="content"> 
   
   
      
      <div class="navbar navbar-default  navbar-fixed-top" role="navigation">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">my public memo</a>
          </div>
          <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
              <li>
        <a href="index.html">Home</a>
      </li>
      <li>
        <a href="midori1.html">緑本</a>
      </li>
      <li>
        <a href="baba1.html">馬場本1部</a>
      </li>
      <li>
        <a href="baba2.html">馬場本2部</a>
      </li>
      <li>
        <a href="baba3.html">馬場本3部</a>
      </li>
      <li>
        <a href="baba4.html">馬場本4部</a>
      </li>
      <li>
        <a href="psytech.html">技術部</a>
      </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              
            </ul>
          </div><!--/.nav-collapse -->
        </div><!--/.container -->
      </div><!--/.navbar -->
        
      <h1 class="title">midori3</h1>
      
      <p class="authors">
           <span class="glyphicon glyphicon-user"></span> Toshihide
Imaruoka
      </p>
              

   
      
   
<!-- Don't indent these lines or it will mess pre blocks indentation --> 
<div class="page-content has-page-title">
<div id="一般化線形モデルーポアソン回帰" class="section level1">
<h1>3. 一般化線形モデルーポアソン回帰</h1>
<ul>
<li>説明変数を組み込んだモデル
<ul>
<li>個体ごとに異なる説明変数を組み込む</li>
<li>ポアソン回帰</li>
</ul></li>
</ul>
<div id="例題個体ごとに平均種子数が異なる場合" class="section level2">
<h2>3.1 例題：個体ごとに平均種子数が異なる場合</h2>
<ul>
<li>架空の植物100個
<ul>
<li>個体<span class="math inline">\(_i\)</span></li>
<li>種子数<span class="math inline">\(y_i\)</span></li>
<li>体サイズ<span class="math inline">\(x_i\)</span>: 正の実数</li>
<li>施肥処理<span class="math inline">\(f_i\)</span>: C処理なし,
T処理あり; 50体ずつ
<ul>
<li>体サイズと施肥処理は独立</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="観測されたデータの概要を調べる" class="section level2">
<h2>3.2 観測されたデータの概要を調べる</h2>
<ul>
<li>R でデータ読み込み、処理</li>
</ul>
<pre class="r"><code>dat&lt;-read.csv(&#39;kubobook_2012-2/poisson/data3a.csv&#39;)
dat$f&lt;-as.factor(dat$f)
summary(dat)</code></pre>
<pre><code>##        y               x          f     
##  Min.   : 2.00   Min.   : 7.190   C:50  
##  1st Qu.: 6.00   1st Qu.: 9.428   T:50  
##  Median : 8.00   Median :10.155         
##  Mean   : 7.83   Mean   :10.089         
##  3rd Qu.:10.00   3rd Qu.:10.685         
##  Max.   :15.00   Max.   :12.400</code></pre>
</div>
<div id="統計モデリングの前にデータを図示する" class="section level2">
<h2>3.3 統計モデリングの前にデータを図示する</h2>
<ul>
<li>データをよく見ておくこと大事</li>
</ul>
<pre class="r"><code>plot(dat$x, dat$y, pch=c(21,19)[dat$f])
legend(&#39;topleft&#39;, legend=c(&quot;C&quot;,&quot;T&quot;), pch=c(21,19))</code></pre>
<p><img src="midori3_files/figure-html/unnamed-chunk-2-1.png" width="768" /></p>
<pre class="r"><code>plot(dat$f,dat$y)</code></pre>
<p><img src="midori3_files/figure-html/unnamed-chunk-2-2.png" width="768" /></p>
</div>
<div id="ポアソン回帰の統計モデル" class="section level2">
<h2>3.4 ポアソン回帰の統計モデル</h2>
<ul>
<li>カウントデータなのでポアソン分布でばらつきを表現できるはず</li>
<li>平均種子数<span
class="math inline">\(\lambda_i\)</span>が体サイズxや施肥処理fに影響される</li>
<li>まずは体サイズ<span
class="math inline">\(x_i\)</span>だけに影響されるというモデル
<ul>
<li><span
class="math inline">\(p(y_i|\lambda_i)=\frac{\lambda_i^{y_i}exp(-\lambda_i)}{y_i!}\)</span></li>
</ul></li>
</ul>
<div id="線形予測子と対数リンク関数" class="section level3">
<h3>3.4.1 線形予測子と対数リンク関数</h3>
<ul>
<li>ここでは平均<span
class="math inline">\(\lambda_i\)</span>は説明変数<span
class="math inline">\(x_i\)</span>の関数であるとしている。そこで、
<ul>
<li><span
class="math inline">\(\lambda_i=exp(\beta_1+\beta_2x_i)\)</span></li>
<li>図示してみると、パラメータ(<span class="math inline">\(\beta_1,
\beta_2\)</span>)によって体サイズと平均種子数の関係が大きく変化することが分かる</li>
<li>ここでは、右辺がexp()である理由は説明されていないことに注意</li>
</ul></li>
<li>線形予測子(linear predictor)とリンク関数(link function)
<ul>
<li>さっきの式は、下のように変形可能（両辺にlog）
<ul>
<li><span
class="math inline">\(log\lambda_i=\beta_1+\beta_2x_i\)</span></li>
</ul></li>
<li>右辺が項の線形和となったので、これを線形予測子と呼ぶ</li>
<li>このとき、左辺が<span
class="math inline">\(\lambda\)</span>の関数となり、右辺が線形予測子。このときの左辺の関数をリンク関数と呼ぶ。今の場合は対数リンク関数。
<ul>
<li>ポアソン回帰の場合は、対数リンク関数を使うのが普通。</li>
</ul></li>
<li>正準リンク関数
<ul>
<li>ポアソン回帰には対数リンク関数</li>
<li>ロジスティック回帰にはリジットリンク関数</li>
<li>これらを正準リンク関数と呼ぶ
<ul>
<li>計算に都合が良い＝ポアソン回帰の場合、パラメータが負になり得ない</li>
<li>分かりやすい＝効果が項同士の積で表される(expだから)→3.6で説明</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="あてはめとあてはまりの良さ" class="section level3">
<h3>3.4.2 あてはめとあてはまりの良さ</h3>
<ul>
<li>ポアソン回帰＝データに対するポアソン分布を使った統計モデルの「あてはめ」
<ul>
<li>いろいろなあてはめの可能性がある中で、対数尤度logLが最大になるパラメータを決める</li>
<li>あるデータYのもとでの対数尤度は
<ul>
<li><span
class="math inline">\(logL(\beta_1,\beta_2)=\Sigma_ilog\frac{\lambda^{y_i}exp(-\lambda_i)}{y_i!}\)</span></li>
<li>ここで、<span
class="math inline">\(\lambda_i\)</span>はパラメータ<span
class="math inline">\(\beta_1と\beta_2\)</span>の関数</li>
<li>2章ではパラメータが1つだったので対数尤度の最大値は簡単に求められたけど、2つだとそうはいかない。
<ul>
<li>そこで「数値を使った試行錯誤」＝MCMC</li>
<li>ただし、いきなりMCMCというわけではなく、RではGLMについてはglm関数で最尤推定ができる。以下、ここで使ってるデータの例。</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<pre class="r"><code>fit&lt;-glm(y~x, data=dat, family=poisson)
print(fit)</code></pre>
<pre><code>## 
## Call:  glm(formula = y ~ x, family = poisson, data = dat)
## 
## Coefficients:
## (Intercept)            x  
##     1.29172      0.07566  
## 
## Degrees of Freedom: 99 Total (i.e. Null);  98 Residual
## Null Deviance:       89.51 
## Residual Deviance: 84.99     AIC: 474.8</code></pre>
<pre class="r"><code>summary(fit)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ x, family = poisson, data = dat)
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  1.29172    0.36369   3.552 0.000383 ***
## x            0.07566    0.03560   2.125 0.033580 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 89.507  on 99  degrees of freedom
## Residual deviance: 84.993  on 98  degrees of freedom
## AIC: 474.77
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<pre class="r"><code>logLik(fit)</code></pre>
<pre><code>## &#39;log Lik.&#39; -235.3863 (df=2)</code></pre>
<ul>
<li>結果の読み方まとめ
<ul>
<li>(Intercept)は<span class="math inline">\(\beta_1\)</span></li>
<li>xは<span class="math inline">\(\beta_2\)</span></li>
<li>Estimateは推定値</li>
<li>Std. Error は標準誤差
<ul>
<li>推定値<span
class="math inline">\(\beta_1と\beta_2\)</span>のばらつき（標準偏差）</li>
<li>パラメータ推定値のばらつきSEの推定方法
<ul>
<li>パラメータ推定値のばらつきを正規分布と仮定、さらに対数尤度関数の形が正規分布に近いと仮定。それによってSEを求めている。</li>
</ul></li>
</ul></li>
<li>z
valueは統計量z。最尤推定値/SE（Wald統計量）。最尤推定値が0から離れているかどうかの目安となり得る。</li>
<li>Pr(&gt;|z|)は、平均z値（の絶対値）、標準偏差1の正規分布の無限大から0の面積の2倍。値が大きいと、z値（つまり推定値）が0に近いということになる。今の例でいうと<span
class="math inline">\(\beta_1\)</span>は0と十分に離れてるけど、<span
class="math inline">\(\beta_2\)</span>は結構近い。信頼区間くらいで考えた方が良さそう。</li>
</ul></li>
<li>ある説明変数をモデルに含めるべきかどうかは、第4章のモデル選択で判断すべき
<ul>
<li>あてはまりの改善か、予測の改善か</li>
<li>じゃああてはまりの完全にはWald信頼区間？そういうわけでもなさそうだけど。</li>
</ul></li>
<li>最大対数尤度＝あてはまりの良さ（goodness of fit)
<ul>
<li>logLik()関数</li>
</ul></li>
</ul>
</div>
<div id="ポアソン回帰モデルによる予測" class="section level3">
<h3>3.4.3 ポアソン回帰モデルによる予測</h3>
<ul>
<li>ポアソン回帰の推定結果を使って、体サイズに対する種子数の予測ができる</li>
</ul>
<pre class="r"><code>plot(dat$x, dat$y, pch=c(21,19)[dat$f], ylim=c(min(dat$y), max(dat$y)))
xx&lt;-seq(min(dat$x), max(dat$x), length=100)
par(new=T)
plot(xx, exp(1.29 + 0.0757 * xx), type=&#39;l&#39;, lwd=2, ylim=c(min(dat$y), max(dat$y)))</code></pre>
<p><img src="midori3_files/figure-html/unnamed-chunk-4-1.png" width="768" /></p>
</div>
</div>
<div id="説明変数が因子型の統計モデル" class="section level2">
<h2>3.5 説明変数が因子型の統計モデル</h2>
<ul>
<li>因子型の変数について考えるために施肥効果<span
class="math inline">\(f_i\)</span>について考えてみる
<ul>
<li>まずは体サイズは無視して、施肥効果だけのモデル</li>
<li>glm()を使えば簡単で、y~fとするだけ</li>
<li>ただし、本ではダミー変数を使うという考え方の確認をしている
<ul>
<li>ダミー変数<span class="math inline">\(d_i\)</span>が
<ul>
<li><span class="math inline">\(f_i\)</span>がCのときには<span
class="math inline">\(d_i\)</span>=0</li>
<li><span class="math inline">\(f_i\)</span>がTのときには<span
class="math inline">\(d_i\)</span>=1</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<pre class="r"><code>fit.f&lt;-glm(y~f, data=dat, family=poisson)
print(fit.f)</code></pre>
<pre><code>## 
## Call:  glm(formula = y ~ f, family = poisson, data = dat)
## 
## Coefficients:
## (Intercept)           fT  
##     2.05156      0.01277  
## 
## Degrees of Freedom: 99 Total (i.e. Null);  98 Residual
## Null Deviance:       89.51 
## Residual Deviance: 89.48     AIC: 479.3</code></pre>
<pre class="r"><code>logLik(fit.f)</code></pre>
<pre><code>## &#39;log Lik.&#39; -237.6273 (df=2)</code></pre>
<ul>
<li>最大対数尤度を出すと、体サイズだけのモデルよりも値が小さい＝あてはまりが悪い</li>
<li>ちなみに因子型変数が3水準の場合(肥料Aを与える、Bを与える、どちらも与えない）、A,B,CをAが与えられたかどうか、Bが与えられたかどうかの組み合わせで表す＝項が2つとなる
<ul>
<li>項<span class="math inline">\(d_{i.A}\)</span>と<span
class="math inline">\(d_{i.B}\)</span>を置き、それぞれを0,1で表現する（肥料Aを与えたー与えない、肥料Bを与えたー与えない）</li>
</ul></li>
</ul>
</div>
<div id="説明変数が数量型因子型の統計モデル" class="section level2">
<h2>3.6 説明変数が数量型＋因子型の統計モデル</h2>
<ul>
<li>体サイズ<span class="math inline">\(x_i\)</span>と施肥処理<span
class="math inline">\(f_i\)</span>を両方組み込んだモデル</li>
</ul>
<pre class="r"><code>f.all&lt;-glm(y~x+f, family=poisson, data=dat)
print(f.all)</code></pre>
<pre><code>## 
## Call:  glm(formula = y ~ x + f, family = poisson, data = dat)
## 
## Coefficients:
## (Intercept)            x           fT  
##     1.26311      0.08007     -0.03200  
## 
## Degrees of Freedom: 99 Total (i.e. Null);  97 Residual
## Null Deviance:       89.51 
## Residual Deviance: 84.81     AIC: 476.6</code></pre>
<pre class="r"><code>logLik(f.all)</code></pre>
<pre><code>## &#39;log Lik.&#39; -235.2937 (df=3)</code></pre>
<ul>
<li>最大対数尤度は体サイズのみのときと比べ、少しだけよくなってる
<ul>
<li>これについては第4章で検討</li>
</ul></li>
</ul>
<div id="対数リンク関数のわかりやすさかけ算される効果"
class="section level3">
<h3>3.6.1 対数リンク関数のわかりやすさ：かけ算される効果</h3>
<ul>
<li>y ~ x + f としているけど、対数リンク関数なので実は掛け算
<ul>
<li>log(y) = x + f ということは y = exp(x + f)ということで、y = exp(x) *
exp(f) ということだから。</li>
</ul></li>
<li>ただし、だから対数リンク関数が妥当だ、あるいは正しいという話ではない</li>
<li>図3.8
<ul>
<li>対数リンク関数（種子数はexpで増加）の場合と恒等リンク関数（種子数は線形の増加）を比較</li>
<li>対数リンク関数の場合、種子数が大きいときは施肥の効果が大きくなる</li>
<li>恒等リンク関数の場合、種子数の絶対値に関わらず施肥の効果は一定</li>
</ul></li>
<li>どちらのモデルがより妥当かを意味をよく考えるべき
<ul>
<li>単に当てはまりの良さだけではなく</li>
</ul></li>
</ul>
</div>
</div>
<div id="何でも正規分布何でも直線には無理がある" class="section level2">
<h2>3.7 「何でも正規分布」「何でも直線」には無理がある</h2>
<ul>
<li>GLMで確率分布を正規分布、リンク関数を恒等リンク関数とすれば、線形モデルあるいは一般線形モデル
<ul>
<li>線形モデルの一つである直線回帰（よくやりがち）と一般線形モデルのポアソン回帰を仮想データで比較してみる。ポアソン回帰は線形モデルでは絶対に実現できないことに注意。</li>
</ul></li>
<li>図3.9のデータ
<ul>
<li>左は直線回帰しようとしている
<ul>
<li>多くのおかしな点
<ul>
<li>xが小さいときにはyのばらつきが小さい（0がたくさん）のに対して、xが大きくなるとyのばらつきが大きくなる＝等分散ではない</li>
<li>yが離散値（正規分布は連続量に対する確率分布のはず）</li>
<li>直線回帰の結果、yの予測値が負になるところがある</li>
</ul></li>
<li>おかしい</li>
</ul></li>
<li>右はポアソン回帰の例
<ul>
<li>離散値に無理なく対応</li>
<li>対数リンク関数を使うことでyは負にならない（リンク関数は選べる）</li>
<li>ばらつきの変化にも対応できる</li>
</ul></li>
<li>データの変換（対数変換・角変換など）も以前はよく使われていた（例えば、だんだんばらつきが大きくなるデータに対数変換とか）けど、それが妥当なわけではない</li>
</ul></li>
</ul>
</div>
</div>
</div>

   
   
              </div>
  </div>
  </div>
  </div>
   
      

  <script>
    $(document).ready(function () {

		// add bootstrap table styles to pandoc tables
	$('tr.header').parent('thead').parent('table').addClass('table table-condensed');
		
 		
	    });
  </script>



    <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
	var script = document.createElement("script");
	script.type = "text/javascript";
	script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
	document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>
  
</body>
</html>
